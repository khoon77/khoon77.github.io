<!DOCTYPE html>
<html lang="ko">
<head>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8543542161839992"
     crossorigin="anonymous"></script>
  <meta charset="UTF-8">
  <title>ì£¼ì‹ ë³µë¦¬ ê³„ì‚°ê¸°</title>
  <style>
    body { font-family: Arial; max-width: 800px; margin: auto; padding: 20px; }
    .result-table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    .result-table th, .result-table td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    .ad { margin: 20px 0; border: 1px solid #ddd; padding: 10px; background: #f9f9f9; text-align: center; }
    #chart-container { margin-top: 30px; }
    input[type="text"] { text-align: right; }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

  <h1>ğŸ“ˆ ì£¼ì‹ ë³µë¦¬ ê³„ì‚°ê¸°</h1>

  <label>ì´ˆê¸°ê¸ˆì•¡ (ì›): 
    <input type="text" id="initialAmount" value="1,000,000" autocomplete="off">
  </label><br><br>

  <label>ìˆ˜ìµë¥  (%): 
    <input type="range" id="interestRate" min="1" max="100" value="10">
    <span id="rateDisplay">10%</span>
  </label><br><br>

  <label>ê¸°ê°„ ë‹¨ìœ„ ì„ íƒ:
    <select id="timeUnit">
      <option value="daily">ì¼</option>
      <option value="monthly">ì›”</option>
      <option value="yearly">ë…„</option>
    </select>
  </label><br><br>

  <label>ì´ ê¸°ê°„ (1~30):
    <select id="periodCount"></select>
    <span id="periodUnitLabel">ì¼</span>
  </label><br><br>

  <button onclick="calculateCompound()">ğŸ’¡ ê³„ì‚°í•˜ê¸°</button>

  <div class="ad">[ ì—¬ê¸°ì— ê´‘ê³  ë°°ë„ˆ ì‚½ì… ìœ„ì¹˜ 1 ]</div>

  <div id="resultArea"></div>

  <div id="chart-container">
    <canvas id="compoundChart" width="700" height="350"></canvas>
  </div>

  <div class="ad">[ ì—¬ê¸°ì— ê´‘ê³  ë°°ë„ˆ ì‚½ì… ìœ„ì¹˜ 2 ]</div>

  <script>
    // 1~30 ì˜µì…˜ ìƒì„±
    const periodSelect = document.getElementById("periodCount");
    for(let i=1; i<=30; i++){
      const option = document.createElement("option");
      option.value = i;
      option.textContent = i;
      periodSelect.appendChild(option);
    }

    // ê¸ˆì•¡ ì…ë ¥ì— ì½¤ë§ˆ ìë™ ì‚½ì…
    function formatNumberWithCommas(x) {
      if (isNaN(x) || x === '') return '';
      return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    }
    function uncomma(x) {
      return x.replace(/[^0-9]/g, "");
    }

    const initialInput = document.getElementById("initialAmount");
    initialInput.addEventListener("input", function(e) {
      let val = uncomma(this.value);
      val = val.replace(/^0+/, '');
      if(val) {
        this.value = formatNumberWithCommas(val);
      } else {
        this.value = "";
      }
    });

    document.getElementById("interestRate").oninput = function() {
      document.getElementById("rateDisplay").innerText = this.value + "%";
    };

    document.getElementById("timeUnit").onchange = function() {
      let unit = "ì¼";
      if (this.value === "monthly") unit = "ì›”";
      else if (this.value === "yearly") unit = "ë…„";
      document.getElementById("periodUnitLabel").innerText = unit;
    };

    let compoundChart = null;

    function calculateCompound() {
      const principalStr = uncomma(document.getElementById("initialAmount").value);
      const principal = parseFloat(principalStr);
      const rate = parseFloat(document.getElementById("interestRate").value);
      const timeUnit = document.getElementById("timeUnit").value;
      const periodCount = parseInt(document.getElementById("periodCount").value);

      if(isNaN(principal) || principal <= 0) {
        alert("ì´ˆê¸° ê¸ˆì•¡ì„ ì˜¬ë°”ë¥´ê²Œ ì…ë ¥í•´ ì£¼ì„¸ìš”.");
        return;
      }

      let unitText = '';
      if (timeUnit === "daily") unitText = 'ì¼';
      else if (timeUnit === "monthly") unitText = 'ì›”';
      else unitText = 'ë…„';

      let results = [];
      // ê·¸ë˜í”„ ë°ì´í„°
      const chartLabels = [];
      const chartData = [];

      let amount = principal;
      for (let i = 1; i <= periodCount; i++) {
        amount = amount * (1 + rate / 100);
        let profit = amount - principal;
        results.push({
          period: i,
          total: formatNumberWithCommas(amount.toFixed(0)),
          profit: formatNumberWithCommas(profit.toFixed(0))
        });
        chartLabels.push(i + unitText);
        chartData.push(Number(amount.toFixed(0)));
      }

      let html = `<h2>ğŸ“Š ê²°ê³¼ (${unitText} ë‹¨ìœ„)</h2><table class="result-table">
                    <tr><th>${unitText}</th><th>ì´ ê¸ˆì•¡ (ì›)</th><th>ìˆ˜ìµê¸ˆ (ì›)</th></tr>`;
      results.forEach(r => {
        html += `<tr><td>${r.period}</td><td>${r.total}</td><td>${r.profit}</td></tr>`;
      });
      html += `</table>`;

      document.getElementById("resultArea").innerHTML = html;

      // Chart.js ê·¸ë˜í”„ ê·¸ë¦¬ê¸°
      const ctx = document.getElementById('compoundChart').getContext('2d');
      if (compoundChart) {
        compoundChart.destroy();
      }

      compoundChart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: chartLabels,
          datasets: [{
            label: 'ì´ ê¸ˆì•¡ (ì›)',
            data: chartData,
            fill: true,
            borderColor: 'rgb(75, 192, 192)',
            backgroundColor: 'rgba(75,192,192,0.1)',
            tension: 0.1,
            pointRadius: 2
          }]
        },
        options: {
          responsive: false,
          plugins: {
            legend: { display: true }
          },
          scales: {
            y: {
              beginAtZero: true,
              ticks: {
                callback: function(value) {
                  return formatNumberWithCommas(value) + 'ì›';
                }
              }
            }
          }
        }
      });
    }
  </script>

</body>
</html>
